!function(){function e(e,n,t,o,r,a,i){try{var s=e[a](i),u=s.value}catch(e){return void t(e)}s.done?n(u):Promise.resolve(u).then(o,r)}System.register(["./app-legacy.Dy1QKECF.js"],(function(n,t){"use strict";var o,r,a,i,s,u,l,c,d,h,y,f,m,p,w,b,v,P,g,S,k,C,z,A,I,M,B,O,x,_,E,W,U,j;return{setters:[e=>{o=e.bR,r=e.bP,a=e.bQ,i=e.w,s=e.n,u=e.a3,l=e.bS,c=e.bT,d=e.a,h=e.z,y=e.bV,f=e.h,m=e.g,p=e.eb,w=e.hs,b=e.H,v=e.A,P=e.aa,g=e.ab,S=e.ad,k=e.T,C=e.pL,z=e.pM,A=e.ht,I=e.af,M=e.ag,B=e.B,O=e.pN,x=e.ca,_=e.dv,E=e.fY,W=e.ce,U=e.cc,j=e.pO}],execute:function(){function t(){const e=o(),n=r(),t=a(),f=i(),m=s(),p=f("review.blocks.change_link_label","Change"),{inMemoryAmazonPayParts:{hasPaymentSheetError:w}}=u();return l()?n.status!==c.Available?null:d(h,{onPress:()=>{try{n.sdk.buywithprime.changePaymentMethod({amazonPayOptions:{amazonCheckoutSessionId:t(),isDeclined:e}})}catch(o){w.value=!0,m.notify(new y(`Error on changing buyer payment method. Details: ${o}`,{cause:o}))}},children:p}):null}n("P",T);class D extends Error{constructor(...e){var n,t,o;super(...e),n=this,o="PortableWalletsSandboxError",(t=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(t="name"))in n?Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[t]=o}}function T({wallet:n,isSdkOnly:t=!1}){const{id:o}=f(),r=s(),a=m(),{value:i}=p(),{countryCode:l,presentmentCurrency:h}=null!=i?i:{},y=w(n),O=null==y?void 0:y.configurationParams,[x,_]=b(!1),{inMemoryAmazonPayParts:{buttonStatus:E,sdkStatus:W}}=u(),U=v(null),j=v(null),T=P(),L=g((({errorMessage:e})=>r.notify(new D(e))),[r]),$=g(function(){var r,i=(r=function*(e){W.value={status:c.Loading};const r=yield e.call.configure({configurationParams:O,buyerCountry:l,buyerCurrency:h,shopId:o,cartId:a.sourceId,onlySdk:t});"success"===(null==r?void 0:r.status)?(W.value=function(e,n){return{status:c.Available,sdk:{buywithprime:{changePaymentMethod:({amazonPayOptions:t})=>{if(!t.amazonCheckoutSessionId)throw new D("Missing amazonCheckoutSessionId");n.call.changePaymentMethod({wallet:e,changePaymentParams:{amazonCheckoutSessionId:t.amazonCheckoutSessionId,isDeclined:t.isDeclined}})},changeShippingAddress:({amazonPayOptions:t})=>{if(!t.amazonCheckoutSessionId)throw new D("Missing amazonCheckoutSessionId");n.call.changeShippingAddress({wallet:e,changeShippingParams:{amazonCheckoutSessionId:t.amazonCheckoutSessionId}})},initCheckout:()=>{throw new D('Unexpected invocation of "initCheckout"')},renderButton:()=>{throw new D('Unexpected invocation of "renderButton"')}},Pay:{changePaymentMethod:()=>{throw new D('Unexpected invocation of AmazonPay "changePaymentMethod" in BWP flow')},changeShippingAddress:()=>{throw new D('Unexpected invocation of AmazonPay "changeShippingAddress" in BWP flow')},initCheckout:()=>{throw new D('Unexpected invocation of AmazonPay "initCheckout" in BWP flow')},renderButton:()=>{throw new D('Unexpected invocation of AmazonPay "renderButton" in BWP flow')}}}}}(n,e),t||(E.value={status:"rendered"})):"error"===(null==r?void 0:r.status)&&(L({errorMessage:null==r?void 0:r.message}),W.value={status:c.Error},t||(E.value={status:"error"}))},function(){var n=this,t=arguments;return new Promise((function(o,a){var i=r.apply(n,t);function s(n){e(i,o,a,s,u,"next",n)}function u(n){e(i,o,a,s,u,"throw",n)}s(void 0)}))});return function(e){return i.apply(this,arguments)}}(),[O,l,o,h,a.sourceId,t,n,L,W,E]),q=S(),R=k((()=>({clicked:e=>{var n,t,o;_(!0),T(j),e&&(n=e.skus,t=e.apiClientId,null!==(o=window.Shopify)&&void 0!==o&&null!==(o=o.analytics)&&void 0!==o&&o.publish&&(window.Shopify.analytics.publish(`shopify:app:pixels:load:${t}`,{},{sendTo:"PIXEL-LOADER"}),window.Shopify.analytics.publish("bwp_checkout_widget_click",{skus:n},{sendTo:t})))},closed:()=>_(!1),redirect:({redirectUrl:e,requestPayload:n})=>{try{if(n){if(!U.current)return void r.notify(new C("Form container not found"));z({formContainer:U.current,url:e,requestPayload:n}).submit()}else window.location.assign(e)}catch(t){r.notify(t)}},reportError:L,telemetry:q})),[_,L,r,T,q]);return O?l&&h?d(B,{children:[d("div",{ref:U,style:{display:"none"}}),d(I,{wallet:n,onConnect:$,hostMethods:R,isSdkOnly:t,ref:j}),d(M,{isOpen:x})]}):(r.notify(new A(`[PortableWalletsButton] Attempted to render wallet button for ${n}, but no countryCode or presentmentCurrency was found.`)),null):(r.notify(new A(`[PortableWalletsButton] Attempted to render wallet button for ${n}, but no config was found.`)),null)}const L=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const e=i(),{brand:n,descriptor:o}=O(),r=x(),a=_(),s=!o||!r;return d(B,{children:[a?d(T,{wallet:E.BuyWithPrime,isSdkOnly:!0}):null,d(W,{id:"buyWithPrimePayDetails",label:e("payment.payment_method","Payment method"),summary:s?d(U,{}):d(j,{brand:n,descriptor:o}),action:d(t,{})})]})}},Symbol.toStringTag,{value:"Module"}));n("V",L)}}}))}();

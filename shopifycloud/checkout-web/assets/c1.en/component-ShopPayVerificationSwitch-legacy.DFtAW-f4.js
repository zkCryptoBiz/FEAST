!function(){const e=["anchorTo","email","queueToken"],t=["element"];function n(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,c,"next",e)}function c(e){o(a,r,i,s,c,"throw",e)}s(void 0)}))}}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./app-legacy.Dy1QKECF.js","./useSubscribeMessenger-legacy.y4xzc9Ae.js","./index-legacy.B3r7bQk_.js"],(function(o,i){"use strict";var s,c,l,u,d,p,h,f,m,v,g,y,w,b,k,S,E,P,_,x,M,C,T,L,O,I,A,N,R,D,z,j,B,V,H,U,$,F,W,q,G,K,Q,Y,J,Z,X,ee,te,ne,oe,re,ie,ae,se,ce,le,ue,de,pe,he,fe,me,ve,ge,ye,we,be,ke,Se,Ee,Pe,_e,xe,Me,Ce,Te,Le,Oe,Ie,Ae,Ne;return{setters:[e=>{s=e.hO,c=e.j,l=e.ch,u=e.k,d=e.h,p=e.g,h=e.cn,f=e.T,m=e.cr,v=e.hP,g=e.hQ,y=e.ho,w=e.aY,b=e.H,k=e.ab,S=e.o,E=e.a,P=e.hR,_=e.A,x=e.bX,M=e.hS,C=e.K,T=e.Y,L=e.hT,O=e.B,I=e.bZ,A=e.cq,N=e.hU,R=e.a3,D=e.hV,z=e.hW,j=e.hX,B=e.hY,V=e.cB,H=e.hZ,U=e.h_,$=e.h$,F=e.i0,W=e.i1,q=e.i2,G=e.bH,K=e.i3,Q=e.i4,Y=e.i5,J=e.i6,Z=e.i7,X=e.i8,ee=e.i9,te=e.n,ne=e.ia,oe=e.fl,re=e.w,ie=e.eM,ae=e.ib,se=e.ic,ce=e.id,le=e.ie,ue=e.ig,de=e.ih,pe=e.a4,he=e.ii},e=>{fe=e.p,me=e.S,ve=e.A,ge=e.u,ye=e.M,we=e.a},e=>{be=e.u,ke=e.a,Se=e.i,Ee=e.b,Pe=e.c,_e=e.d,xe=e.e,Me=e.f,Ce=e.A,Te=e.g,Le=e.r,Oe=e.R,Ie=e.h,Ae=e.j,Ne=e.k}],execute:function(){var i=document.createElement("style");i.textContent='.qdHCv{position:absolute;z-index:1000;top:0;left:0}.hgqpU{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1;background-color:rgba(0,0,0,.18);opacity:0;visibility:hidden;transition:opacity calc(var(--x-duration-base) * 5) cubic-bezier(.2,.9,.3,1)}.LTbS5{opacity:1;visibility:visible}.axmya{background-image:linear-gradient(180deg,rgba(0,0,0,0),rgba(0,0,0,.8) 55%)}.JHj7j{--popover-arrow-size: 2.5rem;position:relative;visibility:hidden;opacity:0;height:0;width:0;overflow:hidden;transform:scale(.1) matrix3d(1,0,0,0,0,.8,.5,-.002,0,-.4,.8,0,0,0,0,1);transition-timing-function:cubic-bezier(.2,.9,.3,1);transition-duration:var(--x-duration-base);transition-property:transform,opacity,height;transition-delay:var(--x-duration-base),var(--x-duration-base),0s}.JHj7j:after{box-shadow:0 19px 47px rgba(0,0,0,.35);content:"";z-index:-1;position:absolute;left:5%;right:5%;top:0;height:100%;width:90%;display:block}.JHj7j .hQvGd{min-width:calc(var(--popover-arrow-size) * 2)}.PMbsk:before{background-color:#fff;content:"";position:absolute;z-index:1;border-radius:var(--x-global-border-radius, var(--x-border-radius-base));display:block;transform:rotate(45deg);width:var(--popover-arrow-size);height:var(--popover-arrow-size)}.wA8HY{visibility:visible;opacity:1;height:auto;width:auto;overflow:initial;transform:scale(1) scaleZ(1)}[dir=rtl] .trTaz{transform-origin:100% 15%}[dir=rtl] .trTaz:before{top:20px;right:-8px}[dir=ltr] .trTaz{transform-origin:0% 15%}[dir=ltr] .trTaz:before{top:20px;left:-8px}.trTaz .hQvGd{min-height:calc(var(--popover-arrow-size) * 2)}[dir=rtl] .KMvI7{transform-origin:5% 0%}[dir=rtl] .KMvI7:before{left:20px;top:-8px}[dir=ltr] .KMvI7{transform-origin:95% 0%}[dir=ltr] .KMvI7:before{right:20px;top:-8px}.hQvGd{position:relative;z-index:2;display:flex;background-color:#fff;border-radius:var(--x-global-border-radius, var(--x-border-radius-base))}.xnzQ4{position:fixed;pointer-events:none;opacity:0}.B1y2m{display:block;border-radius:var(--x-global-border-radius, var(--x-border-radius-base))}\n/*$vite$:1*/',document.head.appendChild(i);function Re({children:e,offset:t,arrowOffset:n,contentWidth:o,contentHeight:r,placement:i="inlineEnd",activator:s,open:c}){const l=function(e){const[t,n]=b(null),o=k((()=>{null!==e&&n(e.getBoundingClientRect())}),[e]);return S((()=>(o(),window.addEventListener("resize",o),window.addEventListener("scroll",o),()=>{window.removeEventListener("resize",o),window.removeEventListener("scroll",o)})),[o]),t}(null!=s?s:null),[u,d]=function(){const[e,t]=b(null);return[e,k((e=>{null!==e&&t(e.getBoundingClientRect())}),[])]}(),{offsets:p,spacing:h}=f((()=>{var e,s;return c?function(e,t,n,o,{offset:r=0,arrowOffset:i=0}={}){var s,c,l,u;let d={x:0,y:0},p={left:0,right:0},h=0;if(!t&&!n)return{offsets:d,spacing:h};if(!o){const{clientWidth:e,clientHeight:o}=document.documentElement;return d={x:e/2-t/2,y:o/2-n/2},{offsets:d,spacing:h}}switch(e){case"blockEnd":d={x:"rtl"===(null!==(s=null===(c=document)||void 0===c?void 0:c.dir)&&void 0!==s?s:"ltr")?o.left:o.right-t,y:o.bottom+r};break;case"inlineEnd":d={x:"rtl"===(null!==(l=null===(u=document)||void 0===u?void 0:u.dir)&&void 0!==l?l:"ltr")?o.left-t-r:o.right+r,y:o.top+o.height/2-i}}return p=function(e,t){const n=document.documentElement.clientWidth,o=e.x+t;let r={left:0,right:0};return o>n&&(r=a(a({},r),{},{right:n-o})),e.x<0&&(r=a(a({},r),{},{left:-e.x})),r}(d,t),p.right&&!p.left?(d.x+=p.right,h=-10):!p.right&&p.left&&(d.x=0,h=10),{offsets:d,spacing:h}}(i,null!==(e=o||(null==u?void 0:u.width))&&void 0!==e?e:0,null!==(s=r||(null==u?void 0:u.height))&&void 0!==s?s:0,l,{offset:t,arrowOffset:n}):{offsets:{x:0,y:0},spacing:0}}),[t,n,i,u,l,c,o,r]),{x:m,y:v}=f((()=>c?function({x:e,y:t}){const n=window.devicePixelRatio||1;return{x:Math.round(e*n)/n||0,y:Math.round(t*n)/n||0}}({x:p.x+h+(window.scrollX||window.pageXOffset),y:p.y+(window.scrollY||window.pageYOffset)}):{x:0,y:0}),[p,h,c]),g=f((()=>c?(window.devicePixelRatio||1)<2?`translate(${m}px, ${v}px)`:`translate3d(${m}px, ${v}px, 0)`:"none"),[c,m,v]);return E(P,{children:E("div",{className:"qdHCv",style:a({},u&&{transform:g,MozTransform:g,WebkitTransform:g}),ref:d,"aria-hidden":!c,children:e})})}const De={Backdrop:"hgqpU","Backdrop-visible":"LTbS5",BackdropLinearGradient:"axmya",Popover:"JHj7j",Content:"hQvGd",PopoverArrow:"PMbsk",PopoverOpen:"wA8HY","Popover-placementInlineEnd":"trTaz","Popover-placementBlockEnd":"KMvI7",Bumper:"xnzQ4"},ze=I("Popover");function je({children:e,activator:t,open:n,placement:o="inlineEnd",contentWidth:r,contentHeight:i,onClose:a}){const s=_(null),c=_(null),l=_(null),u=x(void 0,ze),d=M(),p=k((()=>{"BUTTON"===(null==t?void 0:t.tagName)&&(null==t||t.setAttribute("aria-controls",u),null==t||t.setAttribute("aria-expanded",String(n)))}),[t,n,u]),h=k((e=>{null==a||a(e)}),[a]),f=k((e=>{var o;!(e.target instanceof Node)||null!=t&&t.contains(e.target)||!document.contains(e.target)||null!==(o=l.current)&&void 0!==o&&o.contains(e.target)||!n||h(e)}),[h,t,n,l]),m=k((e=>{if(n)switch(e.key){case"Escape":case"Esc":h(),null==t||t.focus()}}),[h,t,n]);C((()=>(document.addEventListener("click",f),()=>{document.removeEventListener("click",f)})),[f]),C((()=>(n&&document.addEventListener("keydown",m,!1),()=>{document.removeEventListener("keydown",m,!1)})),[n,m]),C((()=>{p()})),S((()=>{var e;n&&(null===(e=l.current)||void 0===e||e.focus({preventScroll:!0}))}),[n]);const v=e=>{const t=l.current;if(t){const n=e?A(t):N(t);n?n.focus():t.focus()}},g=T(De.Popover,De[L("Popover-placement",o)],n&&De.PopoverOpen,t&&De.PopoverArrow);return E(O,{children:[E(Re,{activator:t,placement:o,offset:15,arrowOffset:30,open:n,contentWidth:r,contentHeight:i,children:[n&&E("button",{className:De.Bumper,ref:s,"aria-hidden":"true",onFocus:()=>v(!1)}),E("div",{className:g,id:u,ref:l,children:E("div",{className:De.Content,children:e})}),n&&E("button",{className:De.Bumper,ref:c,"aria-hidden":"true",onFocus:()=>v(!0)})]}),E("div",{className:T(De.Backdrop,n&&De["Backdrop-visible"],n&&d&&De.BackdropLinearGradient)})]})}var Be=(e=>(e.Normal="normal",e.CustomerAccount="customer_account",e.AccountsSameStore="accounts_same_store",e.AccountsCrossStore="accounts_cross_store",e))(Be||{});function Ve({email:e,skipVerifyOnLoad:t,iframeReady:n,iframeRef:o,dismissedModalKey:r,readyToDismiss:i,onReadyToDismiss:a,showPopover:s,showToggle:l,popoverActivator:u}){const d=c(),{inMemoryPayPalParts:{accountStatus:h}}=R(),{guestDismissedModalKey:f}=D(),{checkoutSessionIdentifier:v}=p(),g=z(j.ShopPayVerification,{scope:$}),y=B().current.token;return C((()=>{if(t.current&&n)return void(t.current=!1);const i=d&&V(r),a=e&&H(e),s="connected"===h.value.status,c=d&&function(){const e=sessionStorage.getItem(K);if(!e)return!1;const t=Number.parseInt(e,10);return!isNaN(t)&&Date.now()<t}();!n||!a||i||s||c||(g.peek()!==U.Verified?fe(null==o?void 0:o.current,{action:me.Create,email:e,flow:Be.Normal,disableAutoFocus:Boolean(sessionStorage.getItem(f))}):g.value=void 0)}),[e,n]),{onShow:function(){if(!v)throw new m("ShopPayCheckoutIdentifierMissingError::GuestCheckout");d&&V(r)||e&&H(e)&&(i||a(),y&&fe(null==o?void 0:o.current,{action:me.CheckoutQueueToken,queueToken:y}),F(Q,escape(v)),W(j.IdentifiedShopPayUser,escape(v)),F(Y,"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set")),g.value=U.Pending,sessionStorage.getItem(f)?null==l||l(!0):(s(!0,e),null==l||l(!1)))},onHidden:function(){var e;i&&(g.value=U.Dismissed,d&&F(r,"true"),null==u||null===(e=u.current)||void 0===e||e.focus(),s(!1),null==l||l(!0))},onLoggedIn:function(){q(),g.value=U.Verified,G.value="none"}}}const He=[ve.FraudGuard,ve.InvalidPhone,ve.LimitExceeded,ve.PhoneBlocked];function Ue({email:e,onSetEmail:t,skipVerifyOnLoad:n,iframeReady:o,iframeRef:i,readyToDismiss:a,onReadyToDismiss:s,showPopover:c,popoverActivator:l,origin:u,open:d}){const{checkoutSessionIdentifier:h}=p(),{openModal:f}=J(),{exchangeSessionTokenForCookie:g}=ge(),y=_(null),w=_(!1),b=Z(),S=k((()=>{i.current&&fe(i.current,{action:me.Create,email:"",flow:Be.Normal})}),[i]);function E(){return(E=r((function*(e,t){q(),G.value="none",e&&(yield g({token:e,origin:u,in_checkout_profile_preview:t}),window.location.reload())}))).apply(this,arguments)}return C((()=>{i.current&&o&&u===v.C1ModalShopPaySignIn&&(fe(i.current,{action:me.AllowNoInitialEmail}),S(),fe(i.current,{action:me.Ready}))}),[o,i,u,S]),C((()=>{d&&(y.current=null)}),[d]),C((()=>{w.current&&i.current&&o&&(w.current=!1,S())})),C((()=>{function e(){var e;t&&(b.set({email:"",userStatus:X.None}),t(""),null==l||null===(e=l.current)||void 0===e||e.focus()),w.current=!0}return window.addEventListener("shop_pay_verification_reset",e),()=>{window.removeEventListener("shop_pay_verification_reset",e)}}),[l,c,t,i,b]),C((()=>{o&&(n.current?n.current=!1:e&&H(e)&&u!==v.C1ModalShopPaySignIn?(b.set({email:e,userStatus:X.Loading}),fe(null==i?void 0:i.current,{action:me.Create,email:e,flow:Be.Normal})):u!==v.C1ModalShopPaySignIn&&(S(),b.set({email:"",userStatus:X.None})))}),[e,o,n,i,u,b,S,c]),{onShow:function(){if(!h)throw new m("ShopPayCheckoutIdentifierMissingError::ShopPayCheckout");u===v.C1ModalShopPay&&e&&H(e)&&(a||s(),b.set({email:e,userStatus:X.Found}),c(!0,e))},onHidden:function(){if(u===v.C1ModalShopPay&&!a)return;const n=y.current;var o,r;null==t||null==n||n.userStatus===X.Found&&u!==v.C1ModalShopPay&&e||(t(n.email),b.set(n),null==l||null===(o=l.current)||void 0===o||o.focus()),b.get().userStatus===X.Found?f({type:ee.ContinueWithShopPay,email:b.get().email}):null==l||null===(r=l.current)||void 0===r||r.focus(),c(!1),y.current=null},onEmailChange:function(e,t){e?(y.current||b.get().email!==e)&&(y.current={email:e,userStatus:t?X.Found:X.New}):y.current={email:"",userStatus:X.None}},onError:function(e,t,n){if((!n||n===b.get().email)&&(e===ye.ShopifyPayUserNotFound&&He.includes(t)&&(c(!1),f({type:ee.Generic})),n)){const e=t===ve.InvalidEmail;b.set({email:n,userStatus:e?X.Invalid:X.New})}},onLoggedIn:function(e,t){return E.apply(this,arguments)}}}function $e({email:e,onSetEmail:t,open:n,popoverActivator:o,showPopover:r,showToggle:i,urlOrigin:k=v.C1Modal,updatedOrigin:S=k,onIframeLoaded:P}){const x=oe({base:"blockEnd",medium:"inlineEnd"}),[M,T]=b(!1),[L,O]=b(300),[I,A]=b(!1),N=re(),{checkoutSessionIdentifier:R}=p(),D=_(null),{alternate:z}=w(),B=z,[V,H]=b(!1),U=ie.flow.value===ae.UnauthenticatedUser,$=se(e,ue),q=`${R}-${e.replace(/[^a-zA-Z0-9]/g,"")}`,K=ce(),J=_(K),{onShow:Z,onHidden:X,onError:ee,onEmailChange:de,onLoggedIn:pe}=function(e){const t=te(),n=_(e),o=n.current,r=e===n.current?void 0:`Callback hook changed from ${n.current.name} to ${e.name} between renders.`;return C((()=>{r&&t.notify(new ne(`${r} Only the original hook is called.`,"ShopPayError::OnlyOriginalHookCalled"),{severity:"warning",errorClass:"ShopPay::ShopPayVerification::useStableHook"})}),[r,t]),o}(U?Ue:Ve)({email:$,onSetEmail:t,skipVerifyOnLoad:J,iframeReady:M,iframeRef:D,dismissedModalKey:q,readyToDismiss:I,onReadyToDismiss:()=>{setTimeout((()=>A(!0)),1e3)},showPopover:r,showToggle:i,popoverActivator:o,origin:S,open:n});we({hostname:B,targetId:k,onReady:Z,onClosed:function(){H(!0)},onLoggedIn:pe,onHidden:X,onError:function(e,t,n){null==ee||ee(e,t,n),e===ye.ShopifyPayUserNotFound&&(F(Q,"false"),W(j.IdentifiedShopPayUser,"false")),F(Y,t===ve.LimitExceeded?R||"":"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set"))},onResized:function(e){!isNaN(e)&&e&&O(e)},onLoaded:()=>{T(!0),P()},onEmailChange:de}),C((()=>{fe(null==D?void 0:D.current,{action:me.OriginChanged,origin:S})}),[S]),C((()=>{const e=n?me.Ready:me.Hidden;fe(null==D?void 0:D.current,{action:e}),G.value=n?"shopPayVerification":"none",D.current&&n&&D.current.focus()}),[n]);const he=(e=>{const{alternate:t}=w(),n=s(),o=c(),{iframe_token:r,redirect_url:i,transaction_params:b}=l(),k=u(),{myshopifyDomain:S}=d(),{checkoutSessionIdentifier:E}=p(),P=h();return f((()=>{if(!E)throw new m("ShopPayCheckoutIdentifierMissingError::ULCFrame");if(!P)return;if(!r||!i)return;const s=e===v.C1InlineModal?{[g]:y.ShopPayAsPaymentMethod}:null,c=a({shopify_domain:S,checkout_token:E,origin:e,locale:k,iframe_token:r,redirect_url:i,transaction_params:b,shop_pay_new_signup_login_variant:P},s);null!=o&&o.email&&(c.fast_login=!0);const l=Object.entries(c).map((e=>`${encodeURIComponent(e[0])}=${encodeURIComponent(e[1]||"")}`));n&&l.push(n);const u=l.join("&");return`https://${t}/pay/transactions/new/email?${u}`}),[e,t,S,E,k,r,i,b,P,n,o])})(k);if(C((()=>()=>{T(!1)}),[he]),!he)return null;const ge=n?null==o?void 0:o.current:void 0;return E(je,{activator:ge,open:n,onClose:X,placement:x,contentWidth:320,contentHeight:L,children:E(le,{active:V||!M,size:"large",children:E("iframe",{id:"shop-pay-verification-iframe",title:N("shop_pay.verification.title","Shop Pay Quick Checkout"),ref:D,src:he,height:L,width:320,className:"B1y2m",allow:"publickey-credentials-get *",referrerPolicy:"origin"},he)})})}function Fe({autoOpen:e,email:t,emailInputSelector:n,hideChange:o,iframeRef:i,shouldListen:a=!0}){const{autoOpened:s,loaded:c,modalVisible:l,sessionDetected:u}=Pe(),{leaveBreadcrumb:d,notify:p}=_e(),{trackUserAction:h}=xe(),{isFilledWithPasswordManager:m}=function({emailInputSelector:e}){const[t,n]=b(),[o,r]=b();return C((()=>{function t(e){"password"===this.type?r(e.timeStamp):n(e.timeStamp)}if(e){const n=Ee.querySelector(e);if(n){var o;n.addEventListener("input",t);const e=null===(o=n.form)||void 0===o?void 0:o.querySelector('input[type="password"]');return e&&e instanceof HTMLInputElement&&e.addEventListener("input",t),()=>{n.removeEventListener("input",t),e&&e.removeEventListener("input",t)}}}}),[e]),{isFilledWithPasswordManager:f((()=>void 0!==t&&void 0!==o&&Math.abs(t-o)<100),[t,o])}}({emailInputSelector:n}),v=_(null),[g,y]=b(),[w,S]=b(),[E,P]=b(),x=_(null),M=_(""),T=f((()=>new Set),[]),L=k(function(){var t=r((function*(t,n="",a=""){var f;const g=Me(t);if(m&&!T.has("PASSWORD_MANAGER_AUTOFILL_DETECTED")&&(T.add("PASSWORD_MANAGER_AUTOFILL_DETECTED"),h({userAction:"PASSWORD_MANAGER_AUTOFILL_DETECTED"})),g&&!T.has("EMAIL_ENTERED")&&(T.add("EMAIL_ENTERED"),h({userAction:"EMAIL_ENTERED"})),d("email entered",{},"state"),!i.current||l)return;if(c&&u&&e&&!s)return;const w=g?t:"";!v.current||null!==(f=v.current)&&void 0!==f&&f.signal.aborted||v.current.abort(),v.current=new AbortController;try{var b;const{open:e,postMessage:t,waitForMessage:s}=i.current;M.current=w,t({firstName:n,lastName:a,type:"namesubmitted"}),t({email:w,hideChange:void 0===o?w.length>0:o,type:"emailsubmitted"}),d("email submitted",{email:w?"redacted":""},"state");const c=s("shop_user_matched",v.current.signal),l=new Promise(((e,t)=>{const n=function(){var o=r((function*(){try{const t=yield s("error",v.current.signal);"error"===t.type&&"captcha_challenge"===t.code?e(void 0):n()}catch(o){t(o)}}));return function(){return o.apply(this,arguments)}}();n()}));yield Promise.race([c,l]),e("event_shop_user_matched"),null==x||null===(b=x.current)||void 0===b||b.blur(),function(){if(!function(){const e=Se.userAgent,t=Boolean(e.match(/iPad/i))||Boolean(e.match(/iPhone/i)),n=Boolean(e.match(/WebKit/i));return t&&n&&!e.match(/CriOS/i)}())return;const e="shop-pay-safari-unzoom",t=Ee.getElementById(e);if(t)return t.focus();const n=Ee.createElement("input");n.id=e,n.style.fontSize="16px",n.style.width="1px",n.style.height="1px",n.style.position="fixed",n.style.bottom="-1000px",n.style.right="-1000px",n.style.transform="translate(1000px, 1000px)",n.setAttribute("aria-hidden","true"),Ee.body.appendChild(n),n.focus({preventScroll:!0})}(),v.current.abort(),y(void 0)}catch(k){if(k instanceof Ce&&"AbortSignalReceivedError"===k.name)return;k instanceof Error&&p(new Error(`Error updating user info: ${k.name} - ${k.message}`))}}));return function(e){return t.apply(this,arguments)}}(),[e,s,o,i,m,d,c,l,p,u,h,T]),O=Te(((e,t,n)=>{L(e,t,n)}),200);return C((()=>{void 0!==g&&c&&O(g,w,E)}),[O,g,c,w,E]),C((()=>{if(!n)return;const e=Ee.querySelector(n);if(!e)return;x.current=e;const t=()=>{e&&y(e.value)};if(null!=e&&e.value&&t(),a)return null==e||e.addEventListener("input",t),()=>{null==e||e.removeEventListener("input",t)};null==e||e.removeEventListener("input",t)}),[n,a]),C((()=>{void 0!==t&&y(t)}),[t]),{getSubmittedEmail:()=>M.current,updateEmailToPost:e=>y(e||""),updateNamesToPost:(e,t)=>((e="",t="")=>{S(e),P(t)})(e,t)}}function We(e){const{checkoutToken:t,checkoutVersion:n,shopPermanentDomain:o}=e;return{checkoutVersion:n,checkoutToken:t,flow:"checkout_modal",shopPermanentDomain:o}}const qe=t=>{let{anchorTo:o,email:i,queueToken:s}=t,c=n(t,e);const{modalVisible:l}=Pe(),u=_(null);Fe({email:i,iframeRef:u});const{postMessageAfterLoad:d}=function({iframeRef:e}){const{loaded:t}=Pe();function n(){return(n=r((function*(n){if(!e.current)return;const{postMessage:o,waitForMessage:r}=e.current;t||(yield r("loaded")),o(n)}))).apply(this,arguments)}return{postMessageAfterLoad:function(e){return n.apply(this,arguments)}}}({iframeRef:u}),{trackUserAction:p}=xe(),{leaveBreadcrumb:h}=_e(),m=f((()=>{return{open:(e=r((function*(){var e;l||(null===(e=u.current)||void 0===e||e.open("user_button_clicked"),p({userAction:"OPEN_CALLED"}),h("open called",{},"state"))})),function(){return e.apply(this,arguments)})};var e}),[l,p,h]);!function(e){const{element:t}=be(),{loading:n}=ke();C((()=>{if(t&&!1===n)return Object.entries(e).forEach((([e,n])=>{t.addEventListener(e,n)})),null==t||t._eventListenerReadyPromiseResolve(),()=>{Object.entries(e).forEach((([e,n])=>{null==t||t.removeEventListener(e,n)}))}}),[t,n,e])}(m);const{trackShopPayModalStateChange:v}=function(){const{analyticsData:e,produceMonorailEvent:t}=xe();return{trackShopPayModalStateChange:k((({currentState:n,zoom:o})=>{const{analyticsTraceId:r,checkoutToken:i,checkoutVersion:a,shopPermanentDomain:s}=e,c={previousState:"",currentState:n,clientTimestampMs:(new Date).getTime(),analyticsTraceId:r,checkoutToken:i||"",checkoutVersion:a||"",shopifyDomain:s||"",zoom:o};t({event:{payload:c,schemaId:"shopify_pay_modal_state_change/1.3"}})}),[e,t])}}(),g=k((()=>{var e;v({currentState:"loaded",zoom:`${null===(e=Ie.visualViewport)||void 0===e?void 0:e.scale}`})}),[v]),y=k((e=>{var t;v({currentState:e?"shown":"hidden",zoom:`${null===(t=Ie.visualViewport)||void 0===t?void 0:t.scale}`})}),[v]);C((()=>{s&&d({type:"checkoutqueuetokensubmitted",checkoutQueueToken:s})}),[d,s]);const{authorizeUrl:w}=Ae(a({analyticsContext:"loginWithShopCheckoutModal",avoidSdkSession:!0,clientId:"",disableSignUp:!0,proxy:!0,redirectType:"iframe",responseType:"code"},c));return E(Ne,{anchorTo:o,keepModalOpen:!0,onLoaded:g,onModalVisibleChange:y,proxy:!0,ref:u,src:w,variant:"checkoutModal"})},Ge=({shopCheckoutModal:e,eventName:t,eventListener:n})=>{C((()=>(null==e||e.addEventListener(t,n),()=>null==e?void 0:e.removeEventListener(t,n))),[n,t,e])};function Ke({email:e,open:o,popoverActivator:r,showPopover:i,showToggle:s,onIframeLoaded:u}){const h=null==r?void 0:r.current,f=_(null),[v,g]=b(!1),y=_(!1),{redirect_url:w,transaction_params:S}=l(),{myshopifyDomain:P}=d(),x=c(),{inMemoryPayPalParts:{accountStatus:M}}=R(),{guestDismissedModalKey:T}=D(),{checkoutSessionIdentifier:L}=p(),O=B().current.token;C((()=>{customElements.get("shop-checkout-modal")||Le((e=>{let{element:o}=e,r=n(e,t);return E(Oe,{element:o,monorailProps:We(r),featureName:"ShopCheckoutModal",children:E(qe,a({},r))})}),{methods:["open"],name:"shop-checkout-modal",props:{anchorTo:"string",checkoutRedirectUrl:"string",checkoutToken:"string",checkoutVersion:"string",email:"string",queueToken:"string",shopPermanentDomain:"string",transactionParams:"string"},shadow:"open"})}),[]);const I=z(j.ShopPayVerification,{scope:$}),A=`${L}-${e.replace(/[^a-zA-Z0-9]/g,"")}`,N=ce(),H=_(N);C((()=>{if(H.current)return H.current=!1,void g(!1);const e=sessionStorage.getItem(T),t=x&&V(A),n="connected"===M.peek().status;if(!(e||t||n))return I.peek()===U.Verified?(I.value=void 0,void g(!1)):void g(!0);g(!1)}),[e]);const K=k((()=>{q(),I.value=U.Verified,G.value="none"}),[I]);Ge({shopCheckoutModal:f.current,eventName:"completed",eventListener:K});const Y=k((()=>{if(!L)throw new m("ShopPayCheckoutIdentifierMissingError::ShopJSVerification");F(Q,escape(L)),W(j.IdentifiedShopPayUser,escape(L)),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set")),I.value=U.Pending,null==i||i(!0,e),null==s||s(!1)}),[L,e,I,i,s]);Ge({shopCheckoutModal:f.current,eventName:"modalopened",eventListener:Y});const J=k((()=>{I.value=U.Dismissed,x&&F(A,"true"),null==i||i(!1),null==s||s(y.current)}),[x,A,I,i,s]);Ge({shopCheckoutModal:f.current,eventName:"modalclosed",eventListener:J});const Z=k((()=>{y.current=!0}),[]);Ge({shopCheckoutModal:f.current,eventName:"shopusermatched",eventListener:Z});const X=k((e=>{y.current=!1,F(Q,"false"),W(j.IdentifiedShopPayUser,"false"),window.dispatchEvent(new Event("shop_pay_user_identified_cookie_set"))}),[]);return Ge({shopCheckoutModal:f.current,eventName:"shopusernotmatched",eventListener:X}),Ge({shopCheckoutModal:f.current,eventName:"loaded",eventListener:u}),C((()=>{const e=f.current;G.value=o?"shopPayVerification":"none",h&&o&&(null==e||e.open(),h.blur())}),[h,e,o]),w?E("shop-checkout-modal",{"anchor-to":null!=h&&h.id?`#${h.id}`:"","checkout-redirect-url":w,"checkout-token":L,"checkout-version":"checkout_one",email:o||v?e:"","queue-token":O||"",ref:f,"shop-permanent-domain":P,"transaction-params":S}):null}const Qe=e=>E(O,{children:E(Ke,a({},e))});o("default",(({email:e,onSetEmail:t,open:n,popoverActivator:o,showPopover:r,showToggle:i,urlOrigin:a=v.C1Modal,updatedOrigin:s=v.C1Modal})=>{const c=de(),l=pe(),u=f((()=>he()),[]),d=f((()=>he()),[]),p=_(!0),h=f((()=>{if(void 0!==c)return{isC1:!0,shopJsVerification:!c}}),[c]);C((()=>{H(e)&&(u.mark("start"),p.current=!0)}),[u,e]),C((()=>{if(n&&p.current&&u.marks.start&&h){u.mark("open"),p.current=!1;const e=Math.round(u.marks.open-u.marks.start);l.histogram({name:"shop_pay_verification_time_to_interactive",value:e,attributes:h});const t=Math.round(u.marks.open-Math.max(u.marks.start,u.marks.loaded||0));l.histogram({name:"shop_pay_verification_time_to_interactive_after_load",value:t,attributes:h})}}),[n,l,u,h]),C((()=>{d.mark("start")}),[d]);const m=k((()=>{if(d.marks.start){d.mark("loaded"),u.mark("loaded");const e=Math.round(d.marks.loaded-d.marks.start);l.histogram({name:"shop_pay_verification_iframe_ready_duration",value:e,attributes:h})}}),[d,u,l,h]);return c?E($e,{popoverActivator:o,email:e,onSetEmail:t,open:n,showPopover:r,showToggle:i,urlOrigin:a,updatedOrigin:s,onIframeLoaded:m}):E(Qe,{popoverActivator:o,email:e,open:n,showPopover:r,showToggle:i,onIframeLoaded:m})}))}}}))}();
